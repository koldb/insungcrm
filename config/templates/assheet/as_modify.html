{% extends "base/base2.html" %}
{% block content %}
<style>
  table {
    width: 100%;
    border: 1px solid #dcdcdc;
    border-collapse: collapse;
  }
  th, td {
    border: 1px solid #dcdcdc;
    text-align: center;
  }
  textarea {
    width: 100%;
    height: 15em;
  }
</style>

<script>
   $(function() {
    $("input:text").keydown(function(evt) {
        if (evt.keyCode == 13) return false; });
    });

    $(function () {
      $("#product_name").autocomplete({
          source: '{% url 'isscm:searchData' %}',
          minLength: 1
       });
    });

</script>

<div class="container my-3">
    <form method="POST" action="{% url 'asregister:as_modify' detailView.no %}">
        {% csrf_token %}

        <div class="mb-3">
            <label for="cname">업체명</label>
            <input type="text" class="form-control" name="cname" id="cname" value="{{ detailView.cname }}" readonly>
        </div>

        <div class="mb-3">
            <div>
                <label for="rg_date">고객 접수 일자</label>
                <tr id="rg_date">{{ detailView.rg_date | date:'Y-m-d' }} </tr>
            </div>
            <div>
                <label for="rp_date">처리 완료 일자</label>
                {% if detailView.rp_date == None %}
                <input type="date" value="{{ detailView.rp_date }}" name="rp_date" >
                {% else %}
                <input type="date" value="{{ detailView.rp_date }}" name="rp_date" id="rp_date" >
                {% endif %}
            </div>
        </div>

        <div class="mb-3">
            <label for="product_name">제품명</label>
            <input type="text" class="form-control" name="product_name" id="product_name" value="{{ detailView.product_name }}" >
        </div>
        <div class="mb-3">
            <label for="quantity">수량</label>
            <input type="text" class="form-control" name="quantity" id="quantity" value="{{ detailView.quantity }}" onkeyup="inputNumberFormat(this)">
        </div>
        <div class="mb-3">
            <label for="memo">비고</label>
            {% if login_session == 'insung' %}
            <textarea class="form-control" name="memo" id="memo"  readonly>{{ detailView.memo }}</textarea>
            {% else %}
                {% if detailView.finish == '종료' %}
                <textarea class="form-control" name="memo" id="memo" readonly>{{ detailView.memo }}</textarea>
                {% else %}
                <textarea class="form-control" name="memo" id="memo" >{{ detailView.memo }}</textarea>
                {% endif %}
            {% endif %}
        </div>

        <div class="mb-3">
            {% if login_session == 'insung' %}
            <label for="option">의견</label>
            {% if detailView.option == None %}
            <textarea class="form-control" style="resize: none;" name="option"></textarea>
            {% else %}
            <textarea class="form-control" style="resize: none;" name="option" id="option">{{ detailView.option }}</textarea>
            {% endif %}

            {% else %}
             <label for="option">의견</label>
            {% if detailView.option == None %}
            <textarea class="form-control" style="resize: none;" name="option" readonly></textarea>
            {% else %}
            <textarea class="form-control" style="resize: none;" name="option" id="option"  readonly>{{ detailView.option }}</textarea>
            {% endif %}
            {% endif %}
        </div>

          <div class="mb-3">
            <label for="finish">종결 여부</label>

                {% if login_session == 'insung' %}
                <select name="finish" id="finish">
                {% else %}
                <select name="finish" onFocus="this.initialSelect = this.selectedIndex;" onChange="this.selectedIndex = this.initialSelect;">
                {% endif %}
                {% if detailView.finish == "진행 중" %}
                    <option value="{{ detailView.finish }}">{{ detailView.finish }}</option>
                    <option value="종료">종료</option>
                {% elif detailView.finish == None %}
                    <option value="" selected> </option>
                    <option value="진행 중" >진행 중</option>
                    <option value="종료">종료</option>
                {% else %}
                    <option value="진행 중" >진행 중</option>
                    <option value="종료" selected>종료</option>
                {% endif %}
            </select>
        </div>

        <input type="submit" class="btn btn-primary" value="저장">
        <input type="button" class="btn btn-primary" onclick="location.href='{% url 'asregister:as_detail' detailView.no %}'" value="취소">
    </form>
</div>

{% endblock %}