{% extends "base/base2.html" %}
{% block content %}
{% load humanize %}
{% load filter %}
<style>
    #paging{
        width:150px;
        margin:0 auto;
    }
    tr, td, th{
        border : 1px solid #dcdcdc;
        width : 350px;
        margin: 0 auto;
    }
    tr.m:hover{
     background-color: #98bee0;
     cursor:pointer;
    }
    table {
    text-align: center;
    margin-left:auto;
    margin-right:auto;
    }
    caption {
    caption-side: top;
    text-align: left;
    font-weight : bold;
    color : #2478FF;
    font-size : 21px;
    }
</style>


<!--검색창 부분-->
<div>
    <form action="{% url 'isscm:product_list' %}" method="GET">
        {% csrf_token %}
        <select name="search_sort" id="search_sort">
            <option value="product_name" id="product_name">제품명</option>
            {% if login_session == 'insung' %}
            <option value="cname" id="cname">업체명</option>
            {% endif %}
            <option value="serial" id="serial">시리얼</option>
            <option value="m_title" id="m_title">메인 Title</option>
            <option value="all" id="all">전체</option>
        </select>
        <input type="search"placeholder="검색"  class="form-control mr-sm-2" name="q" value="{{ query }}">
        <button class="btn btn-secondary my-2 my-sm-0" type="submit"><i class="fas fa-search">검색</i></button>
    </form>
</div>
<!--보증기간 리스트-->
<div>
    <table class="board">
        <thead>
        {% if page_obj %}
        <tr class="header" style="text-align:center;">
            <th style="width:5%;">순번</th>
            <th style="width:5%;">등록 일자</th>
            <th style="width:15%;">제품명</th>
            <th style="width:5%;">수량</th>
            <th style="width:5%;">출고 수량</th>
            <th style="width:5%;">개당 단가</th>
            <th style="width:5%;">부가세</th>
            <th style="width:5%;">총 금액</th>
            <th style="width:5%;">업체명</th>
            <th style="width:5%;">메인 번호</th>
            <th style="width:5%;">메인 Title</th>
        </tr>
        </thead>
        <tbody>

        {% for list in page_obj %}
        <tr class="m" style="text-align:center;" onclick="location.href='{% url 'isscm:product_modify' list.id  %}'">
            <td>{{ page_obj.paginator.count|sub:page_obj.start_index|sub:forloop.counter0|add:1  }}</td>
            <td>{{ list.rg_date |date:'Y-m-d' }}</td>
            <td>{{ list.product_name }}</td>
            <td>{{ list.quantity|intcomma }}</td>
            <td>{{ list.enter_quantity|intcomma }}</td>
            <td>{{ list.per_price|intcomma }}</td>
            <td>{{ list.tax|intcomma }}</td>
            <td>{{ list.total_price|intcomma }}</td>
            <td>{{ list.cname }}</td>
            <td>{{ list.m_id_id }}</td>
            <td>{{ list.m_title }}</td>
        </tr>
        {% endfor %}

        {% else %}
        {% endif %}
        </tbody>
    </table>
</div>

<!--페이징 부분-->
<div class = "container" id="paging">
    {#first previous#}
    {% if page_obj.has_previous %}
    <a href="?q={{ query }}&page_obj={{ page_obj }}&page=1&sort={{sort}}&search_sort={{search_sort}}">First</a>
    <a href="?q={{ query }}&page_obj={{ page_obj }}&page={{page_obj.previous_page_number}}&sort={{sort}}&search_sort={{search_sort}}">Previous</a>
    {% endif %}
    {# 3of4 #}
    <span>{{page_obj.number}}</span>
    <span>of</span>
    <span>{{page_obj.paginator.num_pages}}</span>
    {# Next Last #}
    {% if page_obj.has_next %}
    <a href="?q={{ query }}&page_obj={{ page_obj }}&page={{page_obj.next_page_number}}&sort={{sort}}&search_sort={{search_sort}}">Next</a>
    <a href="?q={{ query }}&page_obj={{ page_obj }}&page={{page_obj.paginator.num_pages}}&sort={{sort}}&search_sort={{search_sort}}">Last</a>
    {%endif%}
</div>
<!--정렬-->
<div class="col-4">
    <form method="GET" action="{% url 'isscm:product_list' %}">
        <select name="sort" id="sort">
            <option value="product_name" id="product_name">제품명</option>
            {% if login_session == 'insung' %}
            <option value="cname" id="cname">업체명</option>
            {% endif %}
            <option value="total_price" id="total_price">총 금액</option>
            <option value="m_title" id="m_title">메인 Title</option>
            <option value="all" id="all">전체</option>
        </select>
        <button class="btn btn-primary" type="submit" value="">정렬</button>
        <!--엑셀 다운로드-->
        <a href="{% url 'isscm:main_excel' %}?q={{ query }}&search_sort={{search_sort}}" style="color:white"><button type="button" class="btn btn-primary">EXCEL DOWN</button></a>
    </form>
</div>



{% endblock %}